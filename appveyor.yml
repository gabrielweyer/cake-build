image: Visual Studio 2022
branches:
  only:
    - main
    # We'll also build whenever there is a new commit on any branch starting with `features/`
    - /features\/.+/
build_script:
  - ps: dotnet cake build.cake --bootstrap
  - ps: dotnet cake build.cake --pack
assembly_info:
  # We'll version the binaries and the NuGet package in the build script
  patch: false
# We'll run the tests in the build script
test: off
# AppVeyor will create a release tag if a matching one does not exist
# hence triggering another build
skip_tags: true
# Environment variables
environment:
  # No need to pre-warm the `NuGet` cache
  DOTNET_SKIP_FIRST_TIME_EXPERIENCE: true
# `install` will run before `build_script`
install:
  # Cake build is targeting `.NET` `6.0.x`, so we can safely install the latest supported `SDK`
  # The `SDK` is required to restore, build, publish... a `.NET` application
  # https://www.microsoft.com/net/download/windows
  - ps: .\build\dotnet-install.ps1 -InstallDir 'C:\Program Files\dotnet\'
  - ps: dotnet tool restore